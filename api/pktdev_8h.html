<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<!--<meta charset="utf-8">-->
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CNDP: lib/core/pktdev/pktdev.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="/assets/css/styles.css" rel="stylesheet" type="text/css" />
<link href="/assets/css/custom_doxygen.css" rel="stylesheet" type="text/css" />
<link href="/assets/images/favicon.png" rel="icon" type="image/x-icon">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark bg-blue px-2">
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="/" aria-label="CNDP">
    <img src="/assets/images/CNDP_logo_tiny.png" alt="CNDP">
  </a>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <div class="navbar-nav mr-auto">
      <a class="nav-link header-link" href="/blog/">Blog</a>
      <a class="nav-link header-link" href="/community/">Community</a>
      <a class="nav-link header-link" href="/dev/">Development</a>
      <a class="nav-link header-link" href="/doc/">Documentation</a>
    </div>
    <div class="navbar-nav ms-auto me-3">
      <a class="nav-link header-link" href="https://github.com/CloudNativeDataPlane/cndp">
        <svg xmlns="http://www.w3.org/2000/svg" class="navbar-nav-svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
      </a>
    </div>
  </div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CNDP
   &#160;<span id="projectnumber">22.04.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('pktdev_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">pktdev.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="cne__common_8h_source.html">cne_common.h</a>&gt;</code><br />
<code>#include &lt;net/ethernet.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;x86intrin.h&gt;</code><br />
<code>#include &lt;<a class="el" href="mempool_8h_source.html">mempool.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pktmbuf_8h_source.html">pktmbuf.h</a>&gt;</code><br />
<code>#include &lt;emmintrin.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;tmmintrin.h&gt;</code><br />
<code>#include &lt;<a class="el" href="cne__lport_8h_source.html">cne_lport.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pktdev__api_8h_source.html">pktdev_api.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="pktdev__core_8h_source.html">pktdev_core.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="cne__log_8h_source.html">cne_log.h</a>&quot;</code><br />
</div>
<p><a href="pktdev_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpktdev__rxq__info.html">pktdev_rxq_info</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpktdev__txq__info.html">pktdev_txq_info</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpktdev__portconf.html">pktdev_portconf</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpktdev__info.html">pktdev_info</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a2e3c21f663824ccc40b1e4130c012582"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktdev_8h.html#a2e3c21f663824ccc40b1e4130c012582">PKTDEV_FALLBACK_RX_RINGSIZE</a>&#160;&#160;&#160;512</td></tr>
<tr class="separator:a2e3c21f663824ccc40b1e4130c012582"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abe3980a568daec5be51051bcfcdc16cc"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst</a> (uint16_t lport_id, <a class="el" href="structpktmbuf__s.html">pktmbuf_t</a> **rx_pkts, const uint16_t nb_pkts)</td></tr>
<tr class="separator:abe3980a568daec5be51051bcfcdc16cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b02a8a5fa5d7f4ad8866c5960584337"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktdev_8h.html#a8b02a8a5fa5d7f4ad8866c5960584337">pktdev_tx_burst</a> (uint16_t lport_id, <a class="el" href="structpktmbuf__s.html">pktmbuf_t</a> **tx_pkts, uint16_t nb_pkts)</td></tr>
<tr class="separator:a8b02a8a5fa5d7f4ad8866c5960584337"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab45a1f434f82ecfae7e9c2cffcd58a88"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktdev_8h.html#ab45a1f434f82ecfae7e9c2cffcd58a88">pktdev_tx_prepare</a> (uint16_t lport_id, <a class="el" href="structpktmbuf__s.html">pktmbuf_t</a> **tx_pkts, uint16_t nb_pkts)</td></tr>
<tr class="separator:ab45a1f434f82ecfae7e9c2cffcd58a88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af35f4824ec2fbdf01a00e0890d26da9e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="pktdev_8h.html#af35f4824ec2fbdf01a00e0890d26da9e">pktdev_mac_swap</a> (void *data)</td></tr>
<tr class="separator:af35f4824ec2fbdf01a00e0890d26da9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A simple Ethernet interface routines for AF_XDP and related virtual interfaces. </p>

<p class="definition">Definition in file <a class="el" href="pktdev_8h_source.html">pktdev.h</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a2e3c21f663824ccc40b1e4130c012582"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e3c21f663824ccc40b1e4130c012582">&#9670;&nbsp;</a></span>PKTDEV_FALLBACK_RX_RINGSIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PKTDEV_FALLBACK_RX_RINGSIZE&#160;&#160;&#160;512</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Fallback default preferred Rx/Tx lport parameters. These are used if an application requests default parameters but the PMD does not provide preferred values. </p>

<p class="definition">Definition at line <a class="el" href="pktdev_8h_source.html#l00036">36</a> of file <a class="el" href="pktdev_8h_source.html">pktdev.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="abe3980a568daec5be51051bcfcdc16cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe3980a568daec5be51051bcfcdc16cc">&#9670;&nbsp;</a></span>pktdev_rx_burst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t pktdev_rx_burst </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>lport_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpktmbuf__s.html">pktmbuf_t</a> **&#160;</td>
          <td class="paramname"><em>rx_pkts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const uint16_t&#160;</td>
          <td class="paramname"><em>nb_pkts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Retrieve a burst of input packets from a receive queue of an Ethernet/virtual device. The retrieved packets are stored in <em>pktmbuf</em> structures whose pointers are supplied in the <em>rx_pkts</em> array.</p>
<p>The <a class="el" href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst()</a> function loops, parsing the RX ring of the receive queue, up to <em>nb_pkts</em> packets, and for each completed RX descriptor in the ring, it performs the following operations:</p>
<ul>
<li>Initialize the <em>pktmbuf</em> data structure associated with the RX descriptor according to the information provided by the NIC into that RX descriptor.</li>
<li>Store the <em>pktmbuf</em> data structure into the next entry of the <em>rx_pkts</em> array.</li>
<li>Replenish the RX descriptor with a new <em>pktmbuf</em> buffer allocated from the memory pool associated with the receive queue at initialization time.</li>
</ul>
<p>The <a class="el" href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst()</a> function returns the number of packets actually retrieved, which is the number of <em>pktmbuf</em> data structures effectively supplied into the <em>rx_pkts</em> array. A return value equal to <em>nb_pkts</em> indicates that the RX queue contained at least <em>rx_pkts</em> packets, and this is likely to signify that other received packets remain in the input queue. Applications implementing a "retrieve as much received packets as possible" policy can check this specific case and keep invoking the <a class="el" href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst()</a> function until a value less than <em>nb_pkts</em> is returned.</p>
<p>This receive method has the following advantages:</p>
<ul>
<li>It allows a run-to-completion network stack engine to retrieve and to immediately process received packets in a fast burst-oriented approach, avoiding the overhead of unnecessary intermediate packet queue/dequeue operations.</li>
<li>Conversely, it also allows an asynchronous-oriented processing method to retrieve bursts of received packets and to immediately queue them for further parallel processing by another logical core, for instance. However, instead of having received packets being individually queued by the driver, this approach allows the caller of the <a class="el" href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst()</a> function to queue a burst of retrieved packets at a time and therefore dramatically reduce the cost of enqueue/dequeue operations per packet.</li>
<li>It allows the <a class="el" href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst()</a> function of the driver to take advantage of burst-oriented hardware features (CPU cache, prefetch instructions, and so on) to minimize the number of CPU cycles per packet.</li>
</ul>
<p>To summarize, the proposed receive API enables many burst-oriented optimizations in both synchronous and asynchronous packet processing environments with no overhead in both cases.</p>
<p>The <a class="el" href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst()</a> function does not provide any error notification to avoid the corresponding overhead. As a hint, the upper-level application might check the status of the device link once being systematically returned a 0 value for a given number of tries.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lport_id</td><td>The lport identifier of the Ethernet device. </td></tr>
    <tr><td class="paramname">rx_pkts</td><td>The address of an array of pointers to <em>pktmbuf</em> structures that must be large enough to store <em>nb_pkts</em> pointers in it. </td></tr>
    <tr><td class="paramname">nb_pkts</td><td>The maximum number of packets to retrieve. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of packets actually retrieved, which is the number of pointers to <em>pktmbuf</em> structures effectively supplied to the <em>rx_pkts</em> array. </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="examples_2cndpfwd_2acl-func_8c-example.html#a18">examples/cndpfwd/acl-func.c</a>, <a class="el" href="examples_2cndpfwd_2main_8c-example.html#a4">examples/cndpfwd/main.c</a>, and <a class="el" href="examples_2dlb_test_2dlb_test_8c-example.html#a16">examples/dlb_test/dlb_test.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pktdev_8h_source.html#l00182">182</a> of file <a class="el" href="pktdev_8h_source.html">pktdev.h</a>.</p>

</div>
</div>
<a id="a8b02a8a5fa5d7f4ad8866c5960584337"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b02a8a5fa5d7f4ad8866c5960584337">&#9670;&nbsp;</a></span>pktdev_tx_burst()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t pktdev_tx_burst </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>lport_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpktmbuf__s.html">pktmbuf_t</a> **&#160;</td>
          <td class="paramname"><em>tx_pkts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>nb_pkts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Send a burst of output packets on a transmit queue of an Ethernet/virtual device.</p>
<p>The <a class="el" href="pktdev_8h.html#a8b02a8a5fa5d7f4ad8866c5960584337">pktdev_tx_burst()</a> function is invoked to transmit output packets on the output queue <em>queue_id</em> of the device designated by its <em>lport_id</em>.</p>
<p>The <em>nb_pkts</em> parameter is the number of packets to send which are supplied in the <em>tx_pkts</em> array of <em>pktmbuf</em> structures, each of them allocated from a pool created with <a class="el" href="pktmbuf_8h.html#ae0718571a50946ff3a9bbf29a3615aaf">pktmbuf_pool_create()</a>. The <a class="el" href="pktdev_8h.html#a8b02a8a5fa5d7f4ad8866c5960584337">pktdev_tx_burst()</a> function loops, sending <em>nb_pkts</em> packets, up to the number of transmit descriptors available in the TX ring of the transmit queue. For each packet to send, the <a class="el" href="pktdev_8h.html#a8b02a8a5fa5d7f4ad8866c5960584337">pktdev_tx_burst()</a> function performs the following operations:</p>
<ul>
<li>Pick up the next available descriptor in the transmit ring.</li>
<li>Free the network buffer previously sent with that descriptor, if any.</li>
<li>Initialize the transmit descriptor with the information provided in the *pktmbuf data structure.</li>
</ul>
<p>In the case of a segmented packet composed of a list of <em>pktmbuf</em> buffers, the <a class="el" href="pktdev_8h.html#a8b02a8a5fa5d7f4ad8866c5960584337">pktdev_tx_burst()</a> function uses several transmit descriptors of the ring.</p>
<p>The <a class="el" href="pktdev_8h.html#a8b02a8a5fa5d7f4ad8866c5960584337">pktdev_tx_burst()</a> function returns the number of packets it actually sent. A return value equal to <em>nb_pkts</em> means that all packets have been sent, and this is likely to signify that other output packets could be immediately transmitted again. Applications that implement a "send as many packets to transmit as possible" policy can check this specific case and keep invoking the <a class="el" href="pktdev_8h.html#a8b02a8a5fa5d7f4ad8866c5960584337">pktdev_tx_burst()</a> function until a value less than <em>nb_pkts</em> is returned.</p>
<p>It is the responsibility of the <a class="el" href="pktdev_8h.html#a8b02a8a5fa5d7f4ad8866c5960584337">pktdev_tx_burst()</a> function to transparently free the memory buffers of packets previously sent.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="pktdev_8h.html#ab45a1f434f82ecfae7e9c2cffcd58a88">pktdev_tx_prepare</a> to perform some prior checks or adjustments for <a class="el" href="structoffloads.html">offloads</a>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lport_id</td><td>The lport identifier of the Ethernet device. </td></tr>
    <tr><td class="paramname">tx_pkts</td><td>The address of an array of <em>nb_pkts</em> pointers to <em>pktmbuf</em> structures which contain the output packets. </td></tr>
    <tr><td class="paramname">nb_pkts</td><td>The maximum number of packets to transmit. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of output packets actually stored in transmit descriptors of the transmit ring. The return value can be less than the value of the <em>tx_pkts</em> parameter when the transmit ring is full or has been filled up. </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="examples_2cndpfwd_2main_8c-example.html#a6">examples/cndpfwd/main.c</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="pktdev_8h_source.html#l00256">256</a> of file <a class="el" href="pktdev_8h_source.html">pktdev.h</a>.</p>

</div>
</div>
<a id="ab45a1f434f82ecfae7e9c2cffcd58a88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab45a1f434f82ecfae7e9c2cffcd58a88">&#9670;&nbsp;</a></span>pktdev_tx_prepare()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t pktdev_tx_prepare </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>lport_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpktmbuf__s.html">pktmbuf_t</a> **&#160;</td>
          <td class="paramname"><em>tx_pkts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>nb_pkts</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Process a burst of output packets on a transmit queue of an Ethernet device.</p>
<p>The <a class="el" href="pktdev_8h.html#ab45a1f434f82ecfae7e9c2cffcd58a88">pktdev_tx_prepare()</a> function is invoked to prepare output packets to be transmitted on the output queue <em>queue_id</em> of the device designated by its <em>lport_id</em>. The <em>nb_pkts</em> parameter is the number of packets to be prepared which are supplied in the <em>tx_pkts</em> array of <em>pktmbuf</em> structures, each of them allocated from a pool created with <a class="el" href="pktmbuf_8h.html#ae0718571a50946ff3a9bbf29a3615aaf">pktmbuf_pool_create()</a>. For each packet to send, the <a class="el" href="pktdev_8h.html#ab45a1f434f82ecfae7e9c2cffcd58a88">pktdev_tx_prepare()</a> function performs the following operations:</p>
<ul>
<li>Check if packet meets devices requirements for tx offloads.</li>
<li>Check limitations about number of segments.</li>
<li>Check additional requirements when debug is enabled.</li>
<li>Update and/or reset required checksums when tx offload is set for packet.</li>
</ul>
<p>Since this function can modify packet data, provided mbufs must be safely writable (e.g. modified data cannot be in shared segment).</p>
<p>The <a class="el" href="pktdev_8h.html#ab45a1f434f82ecfae7e9c2cffcd58a88">pktdev_tx_prepare()</a> function returns the number of packets ready to be sent. A return value equal to <em>nb_pkts</em> means that all packets are valid and ready to be sent, otherwise stops processing on the first invalid packet and leaves the rest packets untouched.</p>
<p>When this functionality is not implemented in the driver, all packets are are returned untouched.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">lport_id</td><td>The lport identifier of the Ethernet device. The value must be a valid lport id. </td></tr>
    <tr><td class="paramname">tx_pkts</td><td>The address of an array of <em>nb_pkts</em> pointers to <em>pktmbuf</em> structures which contain the output packets. </td></tr>
    <tr><td class="paramname">nb_pkts</td><td>The maximum number of packets to process. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of packets correct and ready to be sent. The return value can be less than the value of the <em>tx_pkts</em> parameter when some packet doesn't meet devices requirements with errno set appropriately:<ul>
<li>EINVAL: offload flags are not correctly set</li>
<li>ENOTSUP: the offload feature is not supported by the hardware </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="pktdev_8h_source.html#l00328">328</a> of file <a class="el" href="pktdev_8h_source.html">pktdev.h</a>.</p>

</div>
</div>
<a id="af35f4824ec2fbdf01a00e0890d26da9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af35f4824ec2fbdf01a00e0890d26da9e">&#9670;&nbsp;</a></span>pktdev_mac_swap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void pktdev_mac_swap </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Swap the MAC addresses in a ethernet packet using AVX instructions</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Pointer to the start of the L2 header </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The MAC addresses will be swapped. </dd></dl>
<p>shuffle mask be used to shuffle the 16 bytes. byte 0-5 wills be swapped with byte 6-11. byte 12-15 will keep unchanged.</p>

<p class="definition">Definition at line <a class="el" href="pktdev_8h_source.html#l00349">349</a> of file <a class="el" href="pktdev_8h_source.html">pktdev.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a2d5e495f4b604d04f57d90095a59dd6.html">core</a></li><li class="navelem"><a class="el" href="dir_da8fccdd91d18c4d4b0de12d533ad0a8.html">pktdev</a></li><li class="navelem"><a class="el" href="pktdev_8h.html">pktdev.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>

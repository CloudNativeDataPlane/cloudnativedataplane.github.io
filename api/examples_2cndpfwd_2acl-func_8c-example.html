<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<!--<meta charset="utf-8">-->
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CNDP: examples/cndpfwd/acl-func.c</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="/assets/css/styles.css" rel="stylesheet" type="text/css" />
<link href="/assets/css/custom_doxygen.css" rel="stylesheet" type="text/css" />
<link href="/assets/images/favicon.png" rel="icon" type="image/x-icon">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
</head>
<body>
<nav class="navbar navbar-expand-md navbar-dark bg-blue px-2">
  <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <a class="navbar-brand" href="/" aria-label="CNDP">
    <img src="/assets/images/CNDP_logo_tiny.png" alt="CNDP">
  </a>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <div class="navbar-nav mr-auto">
      <a class="nav-link header-link" href="/blog/">Blog</a>
      <a class="nav-link header-link" href="/community/">Community</a>
      <a class="nav-link header-link" href="/dev/">Development</a>
      <a class="nav-link header-link" href="/doc/">Documentation</a>
    </div>
    <div class="navbar-nav ms-auto me-3">
      <a class="nav-link header-link" href="https://github.com/CloudNativeDataPlane/cndp">
        <svg xmlns="http://www.w3.org/2000/svg" class="navbar-nav-svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
      </a>
    </div>
  </div>
</nav>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CNDP
   &#160;<span id="projectnumber">22.08.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('examples_2cndpfwd_2acl-func_8c-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">examples/cndpfwd/acl-func.c</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/* SPDX-License-Identifier: BSD-3-Clause</span></div>
<div class="line"><span class="comment"> * Copyright (c) 2021-2022 Intel Corporation.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cne__acl_8h.html">cne_acl.h</a>&gt;</span>              <span class="comment">// for cne_acl_field, cne_acl_rule, cne_acl_field_t...</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cne__common_8h.html">cne_common.h</a>&gt;</span>           <span class="comment">// for CNE_PTR_ADD</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cne__ether_8h.html">net/cne_ether.h</a>&gt;</span>        <span class="comment">// for cne_ether_hdr</span></div>
<div class="line"><span class="preprocessor">#include &lt;endian.h&gt;</span>               <span class="comment">// for htobe16</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="jcfg_8h.html">jcfg.h</a>&gt;</span>                 <span class="comment">// for jcfg_lport_t, jcfg_lport_by_index, jcfg_thd_t</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cne__ip_8h.html">net/cne_ip.h</a>&gt;</span>           <span class="comment">// for cne_ipv4_hdr, CNE_IPV4</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdbool.h&gt;</span>              <span class="comment">// for bool</span></div>
<div class="line"><span class="preprocessor">#include &lt;stddef.h&gt;</span>               <span class="comment">// for offsetof, NULL</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span>               <span class="comment">// for uint32_t, uint8_t, uint16_t</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span>                <span class="comment">// for printf</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span>               <span class="comment">// for free, malloc</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span>               <span class="comment">// for memset</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="txbuff_8h.html">txbuff.h</a>&gt;</span>               <span class="comment">// for txbuff_add, txbuff_t</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cne__log_8h.html">cne_log.h</a>&gt;</span>              <span class="comment">// for CNE_ERR_RET, CNE_LOG_ERR</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;main.h&quot;</span>        <span class="comment">// for fwd_port, MAX_BURST, acl_fwd_stats, get_dst_...</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MAX_CATEGORIES     1</span></div>
<div class="line"><span class="preprocessor">#define ACL_DENY_SIGNATURE 0xf0000000</span></div>
<div class="line"><span class="preprocessor">#define MAX_ACL_RULE_NUM   100000</span></div>
<div class="line"><span class="preprocessor">#define ACL_RULES_PER_PAGE 32</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Order in which fields are appearing in field definitions.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">enum</span> { PROTO_FIELD_IPV4, SRC_FIELD_IPV4, DST_FIELD_IPV4, NUM_FIELDS_IPV4 };</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * Order in which fields appear in data.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">enum</span> { ACL_IPV4VLAN_PROTO, ACL_IPV4VLAN_SRC, ACL_IPV4VLAN_DST, ACL_IPV4VLAN_NUM };</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* ACL classify context */</span></div>
<div class="line"><span class="keyword">struct </span>acl_classify_t {</div>
<div class="line">    <span class="keyword">const</span> uint8_t *data_ptrs[BURST_SIZE];</div>
<div class="line">    <a name="_a0"></a><a class="code" href="structpktmbuf__s.html">pktmbuf_t</a> *pkts[BURST_SIZE];</div>
<div class="line">    uint32_t acl_results[BURST_SIZE];</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* ACL context parameters */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structcne__acl__param.html">cne_acl_param</a> acl_param = {.<a name="a2"></a><a class="code" href="structcne__acl__param.html#a8f8f80d37794cde9472343e4487ba3eb">name</a>         = <span class="stringliteral">&quot;CNDPFWD-ACL&quot;</span>,</div>
<div class="line">                                         .rule_size    = CNE_ACL_RULE_SZ(NUM_FIELDS_IPV4),</div>
<div class="line">                                         .max_rule_num = MAX_ACL_RULE_NUM};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define ETH_HDR_LEN         (sizeof(struct cne_ether_hdr))</span></div>
<div class="line"><span class="preprocessor">#define IPV4_PROTO_OFFSET   (offsetof(struct cne_ipv4_hdr, next_proto_id))</span></div>
<div class="line"><span class="preprocessor">#define ACL_DATA_OFFSET     (ETH_HDR_LEN + IPV4_PROTO_OFFSET)</span></div>
<div class="line"><span class="preprocessor">#define SRC_ADDR_OFFSET     (offsetof(struct cne_ipv4_hdr, src_addr))</span></div>
<div class="line"><span class="preprocessor">#define DST_ADDR_OFFSET     (offsetof(struct cne_ipv4_hdr, dst_addr))</span></div>
<div class="line"><span class="preprocessor">#define PROTO_ACL_OFFSET    0</span></div>
<div class="line"><span class="preprocessor">#define SRC_ADDR_ACL_OFFSET (SRC_ADDR_OFFSET - IPV4_PROTO_OFFSET)</span></div>
<div class="line"><span class="preprocessor">#define DST_ADDR_ACL_OFFSET (DST_ADDR_OFFSET - IPV4_PROTO_OFFSET)</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// clang-format off</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span><a name="_a3"></a><a class="code" href="structcne__acl__config.html">cne_acl_config</a> acl_config = {</div>
<div class="line">    .<a name="a4"></a><a class="code" href="structcne__acl__config.html#aed3261c5c26c050f5808d181c9c4b974">num_categories</a> = 1,</div>
<div class="line">    .num_fields     = 3,</div>
<div class="line">    .defs           = {</div>
<div class="line">        {</div>
<div class="line">            .type        = CNE_ACL_FIELD_TYPE_BITMASK,</div>
<div class="line">            .size        = <span class="keyword">sizeof</span>(uint8_t),</div>
<div class="line">            .field_index = PROTO_FIELD_IPV4,</div>
<div class="line">            .input_index = ACL_IPV4VLAN_PROTO,</div>
<div class="line">            .offset      = PROTO_ACL_OFFSET,</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            .type        = CNE_ACL_FIELD_TYPE_MASK,</div>
<div class="line">            .size        = <span class="keyword">sizeof</span>(uint32_t),</div>
<div class="line">            .field_index = SRC_FIELD_IPV4,</div>
<div class="line">            .input_index = ACL_IPV4VLAN_SRC,</div>
<div class="line">            .offset      = SRC_ADDR_ACL_OFFSET,</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            .type        = CNE_ACL_FIELD_TYPE_MASK,</div>
<div class="line">            .size        = <span class="keyword">sizeof</span>(uint32_t),</div>
<div class="line">            .field_index = DST_FIELD_IPV4,</div>
<div class="line">            .input_index = ACL_IPV4VLAN_DST,</div>
<div class="line">            .offset      = DST_ADDR_ACL_OFFSET,</div>
<div class="line">        },</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"><span class="comment">// clang-format on</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>cne_acl_ctx *ctx;</div>
<div class="line"><span class="keyword">static</span> pthread_mutex_t ctx_mutex = PTHREAD_MUTEX_INITIALIZER;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * This is the rule table, however due to the way the ACL works the base struct</span></div>
<div class="line"><span class="comment"> * does not include any actual rule data, so do *not* index the struct directly.</span></div>
<div class="line"><span class="comment"> * Instead, we provide a set of helper functions to perform operations on the</span></div>
<div class="line"><span class="comment"> * rule set. It works like a basic dynamic array.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>acl_rule_table {</div>
<div class="line">    uint8_t *rules; </div>
<div class="line">    <span class="keywordtype">size_t</span> len;     </div>
<div class="line">    <span class="keywordtype">size_t</span> sz;      </div>
<div class="line">    <span class="keywordtype">size_t</span> rule_sz; </div>
<div class="line">} acl_rules = {.rule_sz = CNE_ACL_RULE_SZ(NUM_FIELDS_IPV4)};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>acl_rule_desc {</div>
<div class="line">    uint32_t src_addr;</div>
<div class="line">    uint8_t src_msk;</div>
<div class="line">    uint32_t dst_addr;</div>
<div class="line">    uint8_t dst_msk;</div>
<div class="line">    <span class="keywordtype">bool</span> deny;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define ACL_NUM_PAGES(x) (((x) / ACL_RULES_PER_PAGE) + !!((x) % ACL_RULES_PER_PAGE))</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">struct </span>cne_acl_rule *</div>
<div class="line">acl_tbl_get_rule(<span class="keyword">struct</span> acl_rule_table *tbl, <span class="keyword">const</span> <span class="keywordtype">size_t</span> idx)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">return</span> (<span class="keyword">struct</span> cne_acl_rule *)<a name="a5"></a><a class="code" href="cne__common_8h.html#a3fdc042dfefe78dfca471980900de3b9">CNE_PTR_ADD</a>(tbl-&gt;rules, idx * tbl-&gt;rule_sz);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">acl_tbl_resize(<span class="keyword">struct</span> acl_rule_table *tbl, <span class="keyword">const</span> <span class="keywordtype">size_t</span> new_sz)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> newlen;</div>
<div class="line">    uint8_t *newmem;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* do we need to do anything? */</span></div>
<div class="line">    <span class="keywordflow">if</span> (new_sz &lt;= tbl-&gt;sz)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    newlen = tbl-&gt;rule_sz * new_sz;</div>
<div class="line"> </div>
<div class="line">    newmem = realloc(tbl-&gt;rules, newlen);</div>
<div class="line">    <span class="keywordflow">if</span> (newmem == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line">    tbl-&gt;rules = newmem;</div>
<div class="line">    tbl-&gt;sz    = newlen;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">acl_tbl_clear(<span class="keyword">struct</span> acl_rule_table *tbl)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* just set length to 0, we&#39;ll overwrite stuff on addition anyway */</span></div>
<div class="line">    tbl-&gt;len = 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">acl_tbl_ensure_capacity(<span class="keyword">struct</span> acl_rule_table *tbl, <span class="keyword">const</span> <span class="keywordtype">size_t</span> sz)</div>
<div class="line">{</div>
<div class="line">    uint64_t new_sz;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* can we already fit in requested size? */</span></div>
<div class="line">    <span class="keywordflow">if</span> (sz &lt;= tbl-&gt;sz)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    <span class="comment">/* round-up to nearest power of 2 to avoid excessive reallocs */</span></div>
<div class="line">    new_sz = <a name="a6"></a><a class="code" href="cne__common_8h.html#a7aa967b7cab6ea65a3b2b835c98dea40">cne_align64pow2</a>(sz);</div>
<div class="line">    <span class="comment">/* limit it by max rule number in ACL context */</span></div>
<div class="line">    new_sz = <a name="a7"></a><a class="code" href="cne__common_8h.html#adc05c6fa1a2889ae0476ebda038e1523">CNE_MIN</a>(new_sz, acl_param.<a name="a8"></a><a class="code" href="structcne__acl__param.html#a91a71cf1b8f6c168408bd216322b8437">max_rule_num</a>);</div>
<div class="line">    <span class="comment">/* can the new size at least fit in requested size? */</span></div>
<div class="line">    <span class="keywordflow">if</span> (new_sz &lt; sz)</div>
<div class="line">        <span class="keywordflow">return</span> -ENOSPC;</div>
<div class="line">    <span class="comment">/* do we care about 32-bit targets? */</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> acl_tbl_resize(tbl, new_sz);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">acl_tbl_write_rule(<span class="keyword">struct</span> acl_rule_table *tbl, <span class="keyword">const</span> <span class="keywordtype">size_t</span> idx, <span class="keyword">const</span> <span class="keyword">struct</span> acl_rule_desc *r)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cne_acl_rule *rule = acl_tbl_get_rule(tbl, idx);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* we cannot start with 0 as 0 means no match */</span></div>
<div class="line">    rule-&gt;data.userdata = idx + (r-&gt;deny ? ACL_DENY_SIGNATURE : 1);</div>
<div class="line">    <span class="comment">/* we don&#39;t use categories, so use all of them */</span></div>
<div class="line">    rule-&gt;data.category_mask = -1;</div>
<div class="line">    <span class="comment">/* arbitrary value */</span></div>
<div class="line">    rule-&gt;data.priority = CNE_ACL_MAX_PRIORITY - idx;</div>
<div class="line">    <span class="comment">/* ignore protocol type */</span></div>
<div class="line">    rule-&gt;field[PROTO_FIELD_IPV4].value.u8      = 0;</div>
<div class="line">    rule-&gt;field[PROTO_FIELD_IPV4].mask_range.u8 = 0;</div>
<div class="line">    <span class="comment">/* set source IP and mask */</span></div>
<div class="line">    rule-&gt;field[SRC_FIELD_IPV4].value.u32     = r-&gt;src_addr;</div>
<div class="line">    rule-&gt;field[SRC_FIELD_IPV4].mask_range.u8 = r-&gt;src_msk;</div>
<div class="line">    <span class="comment">/* set destination IP and mask */</span></div>
<div class="line">    rule-&gt;field[DST_FIELD_IPV4].value.u32     = r-&gt;dst_addr;</div>
<div class="line">    rule-&gt;field[DST_FIELD_IPV4].mask_range.u8 = r-&gt;dst_msk;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">acl_tbl_add_rule(<span class="keyword">struct</span> acl_rule_table *tbl, <span class="keyword">const</span> <span class="keyword">struct</span> acl_rule_desc *rule)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> newidx = tbl-&gt;len;</div>
<div class="line"> </div>
<div class="line">    acl_tbl_write_rule(tbl, newidx, rule);</div>
<div class="line">    tbl-&gt;len++;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">acl_add_rule(<span class="keyword">const</span> <span class="keyword">struct</span> acl_rule_desc *rule)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>acl_rule_table *tbl = &amp;acl_rules;</div>
<div class="line">    <span class="keywordtype">size_t</span> newidx              = tbl-&gt;len;</div>
<div class="line">    <span class="keywordtype">int</span> ret, mret;</div>
<div class="line"> </div>
<div class="line">    mret = pthread_mutex_lock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (mret != 0) {</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex lock failed: %s\n&quot;</span>, strerror(mret));</div>
<div class="line">        <span class="keywordflow">return</span> mret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = acl_tbl_ensure_capacity(tbl, newidx);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> unlock;</div>
<div class="line"> </div>
<div class="line">    acl_tbl_add_rule(tbl, rule);</div>
<div class="line"> </div>
<div class="line">unlock:</div>
<div class="line">    mret = pthread_mutex_unlock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (mret != 0)</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex unlock failed: %s\n&quot;</span>, strerror(mret));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">acl_clear(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>acl_rule_table *tbl = &amp;acl_rules;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    ret = pthread_mutex_lock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0) {</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex lock failed: %s\n&quot;</span>, strerror(ret));</div>
<div class="line">        <span class="keywordflow">return</span> ret;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    acl_tbl_clear(tbl);</div>
<div class="line"> </div>
<div class="line">    ret = pthread_mutex_unlock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex unlock failed: %s\n&quot;</span>, strerror(ret));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">int</span></div>
<div class="line">validate_ipv4_pkt(<span class="keyword">const</span> <span class="keyword">struct</span> <a name="_a9"></a><a class="code" href="structcne__ipv4__hdr.html">cne_ipv4_hdr</a> *pkt, uint32_t link_len)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* From http://www.rfc-editor.org/rfc/rfc1812.txt section 5.2.2 */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * 1. The packet length reported by the Link Layer must be large</span></div>
<div class="line"><span class="comment">     * enough to hold the minimum length legal IP datagram (20 bytes).</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> (link_len &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structcne__ipv4__hdr.html">cne_ipv4_hdr</a>))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* 2. The IP checksum must be correct. */</span></div>
<div class="line">    <span class="comment">/* this is checked in H/W */</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * 3. The IP version number must be 4. If the version number is not 4</span></div>
<div class="line"><span class="comment">     * then the packet may be another version of IP, such as IPng or</span></div>
<div class="line"><span class="comment">     * ST-II.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> (((pkt-&gt;<a name="a10"></a><a class="code" href="structcne__ipv4__hdr.html#a0f143df6fd0e09aba2963a160e33ce16">version_ihl</a>) &gt;&gt; 4) != 4)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * 4. The IP header length field must be large enough to hold the</span></div>
<div class="line"><span class="comment">     * minimum length legal IP datagram (20 bytes = 5 words).</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> ((pkt-&gt;<a class="code" href="structcne__ipv4__hdr.html#a0f143df6fd0e09aba2963a160e33ce16">version_ihl</a> &amp; 0xf) &lt; 5)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/*</span></div>
<div class="line"><span class="comment">     * 5. The IP total length field must be large enough to hold the IP</span></div>
<div class="line"><span class="comment">     * datagram header, whose length is specified in the IP header length</span></div>
<div class="line"><span class="comment">     * field.</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keywordflow">if</span> (htobe16(pkt-&gt;<a name="a11"></a><a class="code" href="structcne__ipv4__hdr.html#a6dffae94f7f9ee26c196de168e4b5830">total_length</a>) &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structcne__ipv4__hdr.html">cne_ipv4_hdr</a>))</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> uint16_t</div>
<div class="line">populate_acl_classify(<span class="keyword">struct</span> acl_classify_t *acl_classify_ctx, <a class="code" href="structpktmbuf__s.html">pktmbuf_t</a> **pkts, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> len)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i;</div>
<div class="line">    uint16_t num = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; len; i++) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structcne__ipv4__hdr.html">cne_ipv4_hdr</a> *ipv4_hdr;</div>
<div class="line">        <a class="code" href="structpktmbuf__s.html">pktmbuf_t</a> *m = pkts[i];</div>
<div class="line"> </div>
<div class="line">        ipv4_hdr = <a name="a12"></a><a class="code" href="pktmbuf_8h.html#a9f979d8469cd4829ff0dab30defec34e">pktmbuf_mtod_offset</a>(m, <span class="keyword">struct</span> <a class="code" href="structcne__ipv4__hdr.html">cne_ipv4_hdr</a> *, ETH_HDR_LEN);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Check to make sure the packet is valid (RFC1812) */</span></div>
<div class="line">        <span class="keywordflow">if</span> (validate_ipv4_pkt(ipv4_hdr, m-&gt;<a name="a13"></a><a class="code" href="structpktmbuf__s.html#ad1a572736a10ff6b282c5f43c4ea1ccf">data_len</a>) &lt; 0) {</div>
<div class="line">            <span class="comment">/* not a valid IPv4 packet */</span></div>
<div class="line">            <a name="a14"></a><a class="code" href="pktmbuf_8h.html#a0e9d86dbe08947872697d8105e0dae54">pktmbuf_free</a>(m);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        acl_classify_ctx-&gt;pkts[num]      = m;</div>
<div class="line">        acl_classify_ctx-&gt;data_ptrs[num] = <a class="code" href="pktmbuf_8h.html#a9f979d8469cd4829ff0dab30defec34e">pktmbuf_mtod_offset</a>(m, uint8_t *, ACL_DATA_OFFSET);</div>
<div class="line">        num++;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> num;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">acl_fwd_test(<a name="_a15"></a><a class="code" href="structjcfg__lport.html">jcfg_lport_t</a> *lport, <span class="keyword">struct</span> fwd_info *fwd)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* do we forward non-matching packets? */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> fwd_non_matching = fwd-&gt;test == ACL_PERMISSIVE_TEST;</div>
<div class="line">    <span class="keyword">struct </span>fwd_port *pd         = lport-&gt;priv_;</div>
<div class="line">    <span class="keyword">struct </span>acl_classify_t acl_classify_ctx;</div>
<div class="line">    <span class="keyword">struct </span>acl_fwd_stats *stats = &amp;pd-&gt;acl_stats;</div>
<div class="line">    uint16_t n_pkts, n_filtered, n_permit, n_deny;</div>
<div class="line">    <a name="_a16"></a><a class="code" href="structtxbuff.html">txbuff_t</a> **<a class="code" href="structtxbuff.html">txbuff</a>;</div>
<div class="line">    <span class="keywordtype">int</span> i;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!pd)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structtxbuff.html">txbuff</a> = pd-&gt;thd-&gt;priv_;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* receive buffers from the network */</span></div>
<div class="line">    <span class="keywordflow">switch</span> (fwd-&gt;pkt_api) {</div>
<div class="line">    <span class="keywordflow">case</span> XSKDEV_PKT_API:</div>
<div class="line">        n_pkts = <a name="a17"></a><a class="code" href="xskdev_8h.html#a09fbb296353240bd11bfa29b4332a8e8">xskdev_rx_burst</a>(pd-&gt;xsk, (<span class="keywordtype">void</span> **)pd-&gt;rx_mbufs, BURST_SIZE);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> PKTDEV_PKT_API:</div>
<div class="line">        n_pkts = <a name="a18"></a><a class="code" href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst</a>(pd-&gt;lport, pd-&gt;rx_mbufs, BURST_SIZE);</div>
<div class="line">        <span class="keywordflow">if</span> (n_pkts == PKTDEV_ADMIN_STATE_DOWN)</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        n_pkts = 0;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* prepare ACL classification buffer */</span></div>
<div class="line">    n_filtered = populate_acl_classify(&amp;acl_classify_ctx, pd-&gt;rx_mbufs, n_pkts);</div>
<div class="line"> </div>
<div class="line">    stats-&gt;acl_prefilter_drop += n_pkts - n_filtered;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* if no packets found, exit early */</span></div>
<div class="line">    <span class="keywordflow">if</span> (n_filtered == 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <a name="a19"></a><a class="code" href="cne__acl_8h.html#abe986ab96f413c5dffb15c817eab61f3">cne_acl_classify</a>(ctx, acl_classify_ctx.data_ptrs, acl_classify_ctx.acl_results, n_filtered,</div>
<div class="line">                     MAX_CATEGORIES);</div>
<div class="line"> </div>
<div class="line">    n_deny   = 0;</div>
<div class="line">    n_permit = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; n_filtered; i++) {</div>
<div class="line">        <span class="keyword">const</span> uint32_t res = acl_classify_ctx.acl_results[i];</div>
<div class="line">        <a class="code" href="structpktmbuf__s.html">pktmbuf_t</a> *pkt     = acl_classify_ctx.pkts[i];</div>
<div class="line">        <span class="comment">/* are we dropping this packet? */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">bool</span> deny = (res &amp; ACL_DENY_SIGNATURE) != 0;</div>
<div class="line">        <span class="comment">/* did we match anything? */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">bool</span> permit = (res != 0);</div>
<div class="line">        <span class="comment">/* do we forward this packet? */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">bool</span> forward = !deny &amp;&amp; (fwd_non_matching | permit);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (forward) {</div>
<div class="line">            uint8_t dst_lport = get_dst_lport(<a name="a20"></a><a class="code" href="pktmbuf_8h.html#a77fa2b918e3052b564b228868d58c198">pktmbuf_mtod</a>(pkt, <span class="keywordtype">void</span> *));</div>
<div class="line">            <a class="code" href="structjcfg__lport.html">jcfg_lport_t</a> *dst = <a name="a21"></a><a class="code" href="jcfg_8h.html#a8f77a640370ae4142a4973cdfeaaf7ba">jcfg_lport_by_index</a>(fwd-&gt;jinfo, dst_lport);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (!dst)</div>
<div class="line">                <span class="comment">/* Cannot forward to non-existing port, so echo back on incoming interface */</span></div>
<div class="line">                dst = lport;</div>
<div class="line"> </div>
<div class="line">            MAC_SWAP(<a class="code" href="pktmbuf_8h.html#a77fa2b918e3052b564b228868d58c198">pktmbuf_mtod</a>(pkt, <span class="keywordtype">void</span> *));</div>
<div class="line">            (void)<a name="a22"></a><a class="code" href="txbuff_8h.html#a508b33f57bfcbff9904711de80477a7e">txbuff_add</a>(<a class="code" href="structtxbuff.html">txbuff</a>[dst-&gt;<a name="a23"></a><a class="code" href="structjcfg__lport.html#a9e80a18e17fc4c6a3e11c46abcf1c8ff">lpid</a>], pkt);</div>
<div class="line">            n_permit++;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="comment">/* forward condition failed, drop the packet */</span></div>
<div class="line">            <a class="code" href="pktmbuf_8h.html#a0e9d86dbe08947872697d8105e0dae54">pktmbuf_free</a>(pkt);</div>
<div class="line">            n_deny++;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> nb_lports = jcfg_num_lports(fwd-&gt;jinfo);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nb_lports; i++) {</div>
<div class="line">        <a class="code" href="structjcfg__lport.html">jcfg_lport_t</a> *dst = <a class="code" href="jcfg_8h.html#a8f77a640370ae4142a4973cdfeaaf7ba">jcfg_lport_by_index</a>(fwd-&gt;jinfo, i);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (!dst)</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">/* Could hang here is we can never flush the TX packets */</span></div>
<div class="line">        <span class="keywordflow">while</span> (<a name="a24"></a><a class="code" href="txbuff_8h.html#ad8268b335e77a97f98b3091c73b09c7a">txbuff_count</a>(<a class="code" href="structtxbuff.html">txbuff</a>[dst-&gt;<a class="code" href="structjcfg__lport.html#a9e80a18e17fc4c6a3e11c46abcf1c8ff">lpid</a>]) &gt; 0)</div>
<div class="line">            <a name="a25"></a><a class="code" href="txbuff_8h.html#afdf8f0e841815a554cfeb4c928442f7c">txbuff_flush</a>(<a class="code" href="structtxbuff.html">txbuff</a>[dst-&gt;<a class="code" href="structjcfg__lport.html#a9e80a18e17fc4c6a3e11c46abcf1c8ff">lpid</a>]);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    stats-&gt;acl_deny += n_deny;</div>
<div class="line">    stats-&gt;acl_permit += n_permit;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">add_init_rules(<span class="keyword">struct</span> cne_acl_ctx *ctx)</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#define DST_DENY_RULE_NUM  100  </span><span class="comment">/* Dst IP 100.x.x.0/24 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define SRC_DENY1_RULE_NUM 15   </span><span class="comment">/* Src IP x.0.0.0/8 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define SRC_DENY2_RULE_NUM 15   </span><span class="comment">/* Src IP 101.x.x.0/24 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define ALLOW_RULE_NUM     4096 </span><span class="comment">/* IP 210.x.x.x/32 -&gt; 110.x.x.x/32 */</span><span class="preprocessor"></span></div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i, total_num;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    total_num = DST_DENY_RULE_NUM + SRC_DENY1_RULE_NUM + SRC_DENY2_RULE_NUM + ALLOW_RULE_NUM;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* we know how many rules we will have in advance, so preallocate */</span></div>
<div class="line">    ret = acl_tbl_ensure_capacity(&amp;acl_rules, total_num);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a name="a26"></a><a class="code" href="cne__log_8h.html#ac8c38301b044c47cdcdffa35550bd524">CNE_ERR_RET</a>(<span class="stringliteral">&quot;Failed to allocate ACL rule table: %s\n&quot;</span>, strerror(-ret));</div>
<div class="line"> </div>
<div class="line">    <a name="a27"></a><a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;Creating destination IP deny rules:\n&quot;</span>);</div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;   100.[0-99].0.0/24\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; DST_DENY_RULE_NUM; i++) {</div>
<div class="line">        <span class="keyword">struct </span>acl_rule_desc rule = {0};</div>
<div class="line"> </div>
<div class="line">        rule.dst_addr = <a name="a28"></a><a class="code" href="cne__ip_8h.html#ad3c5377f324aeb2e6822734d62518cdd">CNE_IPV4</a>(100, i, 0, 0);</div>
<div class="line">        rule.dst_msk  = 24;</div>
<div class="line">        rule.deny     = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">        acl_tbl_add_rule(&amp;acl_rules, &amp;rule);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;Creating source IP deny rules...\n&quot;</span>);</div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;   [10-34].0.0.0/8\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; SRC_DENY1_RULE_NUM; i++) {</div>
<div class="line">        <span class="keyword">struct </span>acl_rule_desc rule = {0};</div>
<div class="line"> </div>
<div class="line">        rule.src_addr = <a class="code" href="cne__ip_8h.html#ad3c5377f324aeb2e6822734d62518cdd">CNE_IPV4</a>(10 + i, 0, 0, 0);</div>
<div class="line">        rule.src_msk  = 8;</div>
<div class="line">        rule.deny     = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">        acl_tbl_add_rule(&amp;acl_rules, &amp;rule);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;Creating source IP deny rules...\n&quot;</span>);</div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;   101.0.[0-14].0/24\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; SRC_DENY2_RULE_NUM; i++) {</div>
<div class="line">        <span class="keyword">struct </span>acl_rule_desc rule = {0};</div>
<div class="line"> </div>
<div class="line">        rule.src_addr = <a class="code" href="cne__ip_8h.html#ad3c5377f324aeb2e6822734d62518cdd">CNE_IPV4</a>(101, 0, i, 0);</div>
<div class="line">        rule.src_msk  = 24;</div>
<div class="line">        rule.deny     = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">        acl_tbl_add_rule(&amp;acl_rules, &amp;rule);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;Creating permit IP range remapping rules...\n&quot;</span>);</div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;   210.0.[0-15].[0-255]/32 -&gt; 110.0.[0-15].[0-255]/32\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (i = 0; i &lt; ALLOW_RULE_NUM; i++) {</div>
<div class="line">        <span class="keyword">const</span> uint8_t octet1      = (uint8_t)(i &amp; 0xFF);</div>
<div class="line">        <span class="keyword">const</span> uint8_t octet2      = (uint8_t)((i &gt;&gt; 8) &amp; 0xFF);</div>
<div class="line">        <span class="keyword">struct </span>acl_rule_desc rule = {0};</div>
<div class="line"> </div>
<div class="line">        rule.src_addr = <a class="code" href="cne__ip_8h.html#ad3c5377f324aeb2e6822734d62518cdd">CNE_IPV4</a>(210, 0, octet2, octet1);</div>
<div class="line">        rule.src_msk  = 32;</div>
<div class="line"> </div>
<div class="line">        rule.dst_addr = <a class="code" href="cne__ip_8h.html#ad3c5377f324aeb2e6822734d62518cdd">CNE_IPV4</a>(110, 0, octet2, octet1);</div>
<div class="line">        rule.dst_msk  = 32;</div>
<div class="line"> </div>
<div class="line">        acl_tbl_add_rule(&amp;acl_rules, &amp;rule);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;Adding rules to ACL context...\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ret = <a name="a29"></a><a class="code" href="cne__acl_8h.html#a735470359e5040315f713864c757814f">cne_acl_add_rules</a>(ctx, (<span class="keyword">const</span> <span class="keyword">struct</span> cne_acl_rule *)acl_rules.rules, total_num);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <a class="code" href="cne__log_8h.html#ac8c38301b044c47cdcdffa35550bd524">CNE_ERR_RET</a>(<span class="stringliteral">&quot;Failed to add rules: %s\n&quot;</span>, strerror(-ret));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">thread_paused(<a name="_a30"></a><a class="code" href="structjcfg__info__s.html">jcfg_info_t</a> *j <a name="a31"></a><a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>, <span class="keywordtype">void</span> *obj, <span class="keywordtype">void</span> *arg <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>, <span class="keywordtype">int</span> idx <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>)</div>
<div class="line">{</div>
<div class="line">    <a name="_a32"></a><a class="code" href="structjcfg__thd.html">jcfg_thd_t</a> *thd = obj;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcasecmp(thd-&gt;<a name="a33"></a><a class="code" href="structjcfg__thd.html#a964ece8138f1339f5a2e693190111fed">thread_type</a>, <span class="stringliteral">&quot;main&quot;</span>) == 0)</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> thd-&gt;<a name="a34"></a><a class="code" href="structjcfg__thd.html#ae403285ea303dd26759cbfb5f18404f1">pause</a> ? 0 : -1;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">bool</span></div>
<div class="line">all_threads_stopped(<span class="keyword">struct</span> fwd_info *fwd)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* zero return means all threads stopped */</span></div>
<div class="line">    <span class="keywordflow">return</span> jcfg_thread_foreach(fwd-&gt;jinfo, thread_paused, NULL) == 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">fwd_acl_clear(uds_client_t *c <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>,</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">char</span> *params <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">/* this just clears our rule table, it doesn&#39;t clear the ACL context itself */</span></div>
<div class="line">    acl_clear();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_acl_rule(<span class="keywordtype">char</span> *buf, <span class="keyword">struct</span> acl_rule_desc *rule)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *src_ip_str, *src_mask_str, *dst_ip_str, *dst_mask_str, *rule_str;</div>
<div class="line">    <span class="keyword">struct </span>in_addr src_addr, dst_addr;</div>
<div class="line">    <span class="keywordtype">long</span> src_mask, dst_mask;</div>
<div class="line">    <span class="keywordtype">char</span> *state;</div>
<div class="line">    <span class="keywordtype">bool</span> deny;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* rules have a defined syntax: srcip/mask:dstip/mask:allow|deny */</span></div>
<div class="line">    src_ip_str   = strtok_r(buf, <span class="stringliteral">&quot;/&quot;</span>, &amp;state);</div>
<div class="line">    src_mask_str = strtok_r(NULL, <span class="stringliteral">&quot;:&quot;</span>, &amp;state);</div>
<div class="line">    dst_ip_str   = strtok_r(NULL, <span class="stringliteral">&quot;/&quot;</span>, &amp;state);</div>
<div class="line">    dst_mask_str = strtok_r(NULL, <span class="stringliteral">&quot;:&quot;</span>, &amp;state);</div>
<div class="line">    rule_str     = strtok_r(NULL, <span class="stringliteral">&quot;:&quot;</span>, &amp;state);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (src_ip_str == NULL || src_mask_str == NULL || dst_ip_str == NULL || dst_mask_str == NULL ||</div>
<div class="line">        rule_str == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* try to parse IP address */</span></div>
<div class="line">    <span class="keywordflow">if</span> (inet_aton(src_ip_str, &amp;src_addr) &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    <span class="keywordflow">if</span> (inet_aton(dst_ip_str, &amp;dst_addr) &lt; 0)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* try to parse mask - accept 0 to 32 */</span></div>
<div class="line">    src_mask = strtol(src_mask_str, NULL, 10);</div>
<div class="line">    <span class="keywordflow">if</span> (src_mask &lt; 0 || src_mask &gt; 32)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    dst_mask = strtol(dst_mask_str, NULL, 10);</div>
<div class="line">    <span class="keywordflow">if</span> (dst_mask &lt; 0 || dst_mask &gt; 32)</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcasecmp(<span class="stringliteral">&quot;allow&quot;</span>, rule_str) == 0)</div>
<div class="line">        deny = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(<span class="stringliteral">&quot;deny&quot;</span>, rule_str) == 0)</div>
<div class="line">        deny = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line"> </div>
<div class="line">    rule-&gt;deny     = deny;</div>
<div class="line">    rule-&gt;src_addr = be32toh(src_addr.s_addr);</div>
<div class="line">    rule-&gt;src_msk  = src_mask;</div>
<div class="line">    rule-&gt;dst_addr = be32toh(dst_addr.s_addr);</div>
<div class="line">    rule-&gt;dst_msk  = dst_mask;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">fwd_acl_add_rule(uds_client_t *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *params)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>acl_rule_desc rule = {0};</div>
<div class="line">    <span class="keywordtype">char</span> *buf                 = NULL;</div>
<div class="line">    <span class="keywordtype">int</span> ret;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (params == NULL)</div>
<div class="line">        <span class="keywordflow">goto</span> bad_param;</div>
<div class="line"> </div>
<div class="line">    buf = strdup(params);</div>
<div class="line">    <span class="keywordflow">if</span> (buf == NULL) {</div>
<div class="line">        <a name="a35"></a><a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Failed to allocate memory\&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ret = parse_acl_rule(buf, &amp;rule);</div>
<div class="line">    <span class="comment">/* we don&#39;t need it any more */</span></div>
<div class="line">    free(buf);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> bad_param;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* we&#39;ve parsed the rule, now add it */</span></div>
<div class="line">    ret = acl_add_rule(&amp;rule);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Failed to add ACL rule: %s\&quot;&quot;</span>, strerror(-ret));</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line"> </div>
<div class="line">bad_param:</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Command expects parameter: &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;&lt;src IP&gt;/&lt;src mask&gt;:&lt;dst IP&gt;/&lt;dst mask&gt;:&lt;allow|deny&gt;\&quot;&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">fwd_acl_build(uds_client_t *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *params <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret, mret;</div>
<div class="line">    <span class="keyword">struct </span>fwd_info *fwd = (<span class="keyword">struct </span>fwd_info *)(c-&gt;info-&gt;priv);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* we cannot do anything with ACL context unless all threads are stopped */</span></div>
<div class="line">    <span class="keywordflow">if</span> (!all_threads_stopped(fwd)) {</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Not all forwarding threads are stopped\&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    mret = pthread_mutex_lock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (mret != 0) {</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex lock failed: %s\n&quot;</span>, strerror(mret));</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Mutex lock failed\&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* if there&#39;s already an ACL context, free it */</span></div>
<div class="line">    <span class="keywordflow">if</span> (ctx != NULL) {</div>
<div class="line">        <a name="a36"></a><a class="code" href="cne__acl_8h.html#a73f335ab96b7ed07006b08bcc7c6103a">cne_acl_free</a>(ctx);</div>
<div class="line">        ctx = NULL;</div>
<div class="line">    }</div>
<div class="line">    ctx = <a name="a37"></a><a class="code" href="cne__acl_8h.html#ab62bdf223912367dfa93fb00a443000c">cne_acl_create</a>(&amp;acl_param);</div>
<div class="line">    <span class="keywordflow">if</span> (ctx == NULL) {</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;ACL context not initialized\&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> unlock;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* add all rules */</span></div>
<div class="line">    ret = <a class="code" href="cne__acl_8h.html#a735470359e5040315f713864c757814f">cne_acl_add_rules</a>(ctx, (<span class="keyword">const</span> <span class="keyword">struct</span> cne_acl_rule *)acl_rules.rules, acl_rules.len);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Cannot add ACL rules to context: %s\&quot;&quot;</span>, strerror(-ret));</div>
<div class="line">        <span class="keywordflow">goto</span> unlock;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* build context */</span></div>
<div class="line">    ret = <a name="a38"></a><a class="code" href="cne__acl_8h.html#ab92747ddc9cc81760d7a838a0503f525">cne_acl_build</a>(ctx, &amp;acl_config);</div>
<div class="line">    <span class="keywordflow">if</span> (ret != 0)</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Cannot build ACL context: %s\&quot;&quot;</span>, strerror(-ret));</div>
<div class="line"> </div>
<div class="line">unlock:</div>
<div class="line">    mret = pthread_mutex_unlock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (mret != 0)</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex unlock failed: %s\n&quot;</span>, strerror(mret));</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_acl_info(uds_client_t *c)</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;num rules\&quot;:%zu,&quot;</span>, acl_rules.len);</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;max rules\&quot;:%d,&quot;</span>, acl_param.<a class="code" href="structcne__acl__param.html#a91a71cf1b8f6c168408bd216322b8437">max_rule_num</a>);</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;rule pages\&quot;:%zu,&quot;</span>, ACL_NUM_PAGES(acl_rules.len));</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;rules per page\&quot;:%d&quot;</span>, ACL_RULES_PER_PAGE);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_acl_rule(uds_client_t *c, <span class="keywordtype">size_t</span> idx)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>cne_acl_rule *rule = acl_tbl_get_rule(&amp;acl_rules, idx);</div>
<div class="line">    <span class="keyword">struct </span>in_addr src_addr, dst_addr;</div>
<div class="line">    uint8_t src_msk, dst_msk;</div>
<div class="line">    <span class="keywordtype">char</span> *addr;</div>
<div class="line">    <span class="keywordtype">bool</span> deny;</div>
<div class="line"> </div>
<div class="line">    src_addr.s_addr = htobe32(rule-&gt;field[SRC_FIELD_IPV4].value.u32);</div>
<div class="line">    src_msk         = rule-&gt;field[SRC_FIELD_IPV4].mask_range.u8;</div>
<div class="line">    dst_addr.s_addr = htobe32(rule-&gt;field[DST_FIELD_IPV4].value.u32);</div>
<div class="line">    dst_msk         = rule-&gt;field[DST_FIELD_IPV4].mask_range.u8;</div>
<div class="line">    deny            = !!(rule-&gt;data.userdata &amp; ACL_DENY_SIGNATURE);</div>
<div class="line"> </div>
<div class="line">    addr = inet_ntoa(src_addr);</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;src addr\&quot;:\&quot;%s/%d\&quot;,&quot;</span>, addr, src_msk);</div>
<div class="line">    addr = inet_ntoa(dst_addr);</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;dst addr\&quot;:\&quot;%s/%d\&quot;,&quot;</span>, addr, dst_msk);</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;type\&quot;:\&quot;%s\&quot;&quot;</span>, deny ? <span class="stringliteral">&quot;deny&quot;</span> : <span class="stringliteral">&quot;allow&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span></div>
<div class="line">print_acl_rule_page(uds_client_t *c, <span class="keywordtype">size_t</span> pg)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">size_t</span> start, end, cur;</div>
<div class="line">    <span class="keywordflow">if</span> (pg &gt;= ACL_NUM_PAGES(acl_rules.len)) {</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Wrong page number\&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    start = pg * ACL_RULES_PER_PAGE;</div>
<div class="line">    end   = <a class="code" href="cne__common_8h.html#adc05c6fa1a2889ae0476ebda038e1523">CNE_MIN</a>((pg + 1) * ACL_RULES_PER_PAGE, acl_rules.len);</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;rules\&quot;:[&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (cur = start; cur &lt; end; cur++) {</div>
<div class="line">        <span class="keywordflow">if</span> (cur != start)</div>
<div class="line">            <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;{&quot;</span>);</div>
<div class="line">        print_acl_rule(c, cur);</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;}&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>acl_read_param {</div>
<div class="line">    <span class="keywordtype">bool</span> is_page; </div>
<div class="line">    <span class="keywordtype">size_t</span> num;   </div>
<div class="line">};</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">int</span></div>
<div class="line">parse_acl_read_param(<span class="keyword">const</span> <span class="keywordtype">char</span> *params, <span class="keyword">struct</span> acl_read_param *out)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *type, *num;</div>
<div class="line">    <span class="keywordtype">char</span> *state, *dup, *endp;</div>
<div class="line">    <span class="keywordtype">int</span> ret = -EINVAL;</div>
<div class="line">    int64_t parsed;</div>
<div class="line">    <span class="keywordtype">bool</span> is_page;</div>
<div class="line"> </div>
<div class="line">    dup = strdup(params);</div>
<div class="line">    <span class="keywordflow">if</span> (dup == NULL)</div>
<div class="line">        <span class="keywordflow">return</span> -ENOMEM;</div>
<div class="line"> </div>
<div class="line">    type = strtok_r(dup, <span class="stringliteral">&quot;:&quot;</span>, &amp;state);</div>
<div class="line">    num  = strtok_r(NULL, <span class="stringliteral">&quot;:&quot;</span>, &amp;state);</div>
<div class="line">    <span class="keywordflow">if</span> (type == NULL || num == NULL)</div>
<div class="line">        <span class="keywordflow">goto</span> end;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (strcasecmp(type, <span class="stringliteral">&quot;p&quot;</span>) == 0)</div>
<div class="line">        is_page = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcasecmp(type, <span class="stringliteral">&quot;r&quot;</span>) == 0)</div>
<div class="line">        is_page = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">goto</span> end;</div>
<div class="line"> </div>
<div class="line">    parsed = strtoll(num, &amp;endp, 10);</div>
<div class="line">    <span class="comment">/* there&#39;s some extra data at the end */</span></div>
<div class="line">    <span class="keywordflow">if</span> (*endp != <span class="charliteral">&#39;\0&#39;</span>)</div>
<div class="line">        <span class="keywordflow">goto</span> end;</div>
<div class="line">    <span class="keywordflow">if</span> (parsed &lt; 0)</div>
<div class="line">        <span class="keywordflow">goto</span> end;</div>
<div class="line">    out-&gt;num     = (size_t)parsed;</div>
<div class="line">    out-&gt;is_page = is_page;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* success */</span></div>
<div class="line">    ret = 0;</div>
<div class="line">end:</div>
<div class="line">    free(dup);</div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">fwd_acl_read(uds_client_t *c, <span class="keyword">const</span> <span class="keywordtype">char</span> *cmd <a class="code" href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a>, <span class="keyword">const</span> <span class="keywordtype">char</span> *params)</div>
<div class="line">{</div>
<div class="line">    <span class="keyword">struct </span>acl_read_param prm;</div>
<div class="line">    <span class="keywordtype">int</span> ret, mret;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* don&#39;t allow for anything to happen with rules table */</span></div>
<div class="line">    mret = pthread_mutex_lock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (mret != 0) {</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex lock failed: %s\n&quot;</span>, strerror(mret));</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Mutex lock failed\&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* if no parameters, print out general info on rule table */</span></div>
<div class="line">    <span class="keywordflow">if</span> (params == NULL) {</div>
<div class="line">        print_acl_info(c);</div>
<div class="line">        <span class="keywordflow">goto</span> unlock;</div>
<div class="line">    }</div>
<div class="line">    ret = parse_acl_read_param(params, &amp;prm);</div>
<div class="line">    <span class="keywordflow">if</span> (ret &lt; 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (ret == -ENOMEM)</div>
<div class="line">            <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Cannot allocate memory\&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == -EINVAL)</div>
<div class="line">            <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Parameter must be: &#39;p:&lt;page num&gt;&#39; or &#39;r:&lt;rule num&gt;&#39;\&quot;&quot;</span>);</div>
<div class="line">        <span class="keywordflow">goto</span> unlock;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (prm.is_page) {</div>
<div class="line">        print_acl_rule_page(c, prm.num);</div>
<div class="line">    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (prm.num &gt;= acl_rules.len) {</div>
<div class="line">        <a class="code" href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a>(c, <span class="stringliteral">&quot;\&quot;error\&quot;:\&quot;Wrong ACL rule number\&quot;&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        print_acl_rule(c, prm.num);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">unlock:</div>
<div class="line">    mret = pthread_mutex_unlock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (mret != 0)</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex unlock failed: %s\n&quot;</span>, strerror(mret));</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span></div>
<div class="line">acl_init(<span class="keyword">struct</span> fwd_info *fwd)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> ret = -1, mret;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;Creating ACL context...\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    mret = pthread_mutex_lock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (mret != 0) {</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex lock failed: %s\n&quot;</span>, strerror(mret));</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* create ACL context */</span></div>
<div class="line">    ctx = <a class="code" href="cne__acl_8h.html#ab62bdf223912367dfa93fb00a443000c">cne_acl_create</a>(&amp;acl_param);</div>
<div class="line">    <span class="keywordflow">if</span> (ctx == NULL)</div>
<div class="line">        <a name="a39"></a><a class="code" href="cne__log_8h.html#ad8375acbd0957d02439e7b8d7f3a6e22">CNE_ERR_GOTO</a>(unlock, <span class="stringliteral">&quot;Could not create ACL context\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* add rules to context */</span></div>
<div class="line">    <span class="keywordflow">if</span> (add_init_rules(ctx) &lt; 0)</div>
<div class="line">        <a class="code" href="cne__log_8h.html#ad8375acbd0957d02439e7b8d7f3a6e22">CNE_ERR_GOTO</a>(unlock, <span class="stringliteral">&quot;Could not add ACL rules\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;Building ACL runtime...\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">/* compile ACL matcher bytecode */</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="cne__acl_8h.html#ab92747ddc9cc81760d7a838a0503f525">cne_acl_build</a>(ctx, &amp;acl_config) &lt; 0)</div>
<div class="line">        <a class="code" href="cne__log_8h.html#ad8375acbd0957d02439e7b8d7f3a6e22">CNE_ERR_GOTO</a>(unlock, <span class="stringliteral">&quot;Could not build ACL runtime\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;ACL rule table created successfully\n&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (fwd-&gt;test == ACL_STRICT_TEST) {</div>
<div class="line">        <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;ACL mode: strict\n&quot;</span>);</div>
<div class="line">        <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;All traffic will be dropped unless matching a permit rule\n&quot;</span>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;ACL mode: permissive\n&quot;</span>);</div>
<div class="line">        <a class="code" href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a>(<span class="stringliteral">&quot;All traffic will be forwarded unless matching a deny rule\n&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">/* success */</span></div>
<div class="line">    ret = 0;</div>
<div class="line"> </div>
<div class="line">unlock:</div>
<div class="line">    mret = pthread_mutex_unlock(&amp;ctx_mutex);</div>
<div class="line">    <span class="keywordflow">if</span> (mret != 0)</div>
<div class="line">        CNE_ERR(<span class="stringliteral">&quot;Mutex unlock failed: %s\n&quot;</span>, strerror(mret));</div>
<div class="line">    <span class="keywordflow">return</span> ret;</div>
<div class="line">}</div>
<div class="ttc" id="acne__acl_8h_html"><div class="ttname"><a href="cne__acl_8h.html">cne_acl.h</a></div></div>
<div class="ttc" id="acne__acl_8h_html_a735470359e5040315f713864c757814f"><div class="ttname"><a href="cne__acl_8h.html#a735470359e5040315f713864c757814f">cne_acl_add_rules</a></div><div class="ttdeci">int cne_acl_add_rules(struct cne_acl_ctx *ctx, const struct cne_acl_rule *rules, uint32_t num)</div></div>
<div class="ttc" id="acne__acl_8h_html_a73f335ab96b7ed07006b08bcc7c6103a"><div class="ttname"><a href="cne__acl_8h.html#a73f335ab96b7ed07006b08bcc7c6103a">cne_acl_free</a></div><div class="ttdeci">void cne_acl_free(struct cne_acl_ctx *ctx)</div></div>
<div class="ttc" id="acne__acl_8h_html_ab62bdf223912367dfa93fb00a443000c"><div class="ttname"><a href="cne__acl_8h.html#ab62bdf223912367dfa93fb00a443000c">cne_acl_create</a></div><div class="ttdeci">struct cne_acl_ctx * cne_acl_create(const struct cne_acl_param *param)</div></div>
<div class="ttc" id="acne__acl_8h_html_ab92747ddc9cc81760d7a838a0503f525"><div class="ttname"><a href="cne__acl_8h.html#ab92747ddc9cc81760d7a838a0503f525">cne_acl_build</a></div><div class="ttdeci">int cne_acl_build(struct cne_acl_ctx *ctx, const struct cne_acl_config *cfg)</div></div>
<div class="ttc" id="acne__acl_8h_html_abe986ab96f413c5dffb15c817eab61f3"><div class="ttname"><a href="cne__acl_8h.html#abe986ab96f413c5dffb15c817eab61f3">cne_acl_classify</a></div><div class="ttdeci">int cne_acl_classify(const struct cne_acl_ctx *ctx, const uint8_t **data, uint32_t *results, uint32_t num, uint32_t categories)</div></div>
<div class="ttc" id="acne__common_8h_html"><div class="ttname"><a href="cne__common_8h.html">cne_common.h</a></div></div>
<div class="ttc" id="acne__common_8h_html_a110ce74779a3879ca9ba9167c968cf27"><div class="ttname"><a href="cne__common_8h.html#a110ce74779a3879ca9ba9167c968cf27">__cne_unused</a></div><div class="ttdeci">#define __cne_unused</div><div class="ttdef"><b>Definition:</b> <a href="cne__common_8h_source.html#l00144">cne_common.h:144</a></div></div>
<div class="ttc" id="acne__common_8h_html_a3fdc042dfefe78dfca471980900de3b9"><div class="ttname"><a href="cne__common_8h.html#a3fdc042dfefe78dfca471980900de3b9">CNE_PTR_ADD</a></div><div class="ttdeci">#define CNE_PTR_ADD(ptr, x)</div><div class="ttdef"><b>Definition:</b> <a href="cne__common_8h_source.html#l00235">cne_common.h:235</a></div></div>
<div class="ttc" id="acne__common_8h_html_a7aa967b7cab6ea65a3b2b835c98dea40"><div class="ttname"><a href="cne__common_8h.html#a7aa967b7cab6ea65a3b2b835c98dea40">cne_align64pow2</a></div><div class="ttdeci">static uint64_t cne_align64pow2(uint64_t v)</div><div class="ttdef"><b>Definition:</b> <a href="cne__common_8h_source.html#l00520">cne_common.h:520</a></div></div>
<div class="ttc" id="acne__common_8h_html_adc05c6fa1a2889ae0476ebda038e1523"><div class="ttname"><a href="cne__common_8h.html#adc05c6fa1a2889ae0476ebda038e1523">CNE_MIN</a></div><div class="ttdeci">#define CNE_MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="cne__common_8h_source.html#l00550">cne_common.h:550</a></div></div>
<div class="ttc" id="acne__ether_8h_html"><div class="ttname"><a href="cne__ether_8h.html">cne_ether.h</a></div></div>
<div class="ttc" id="acne__ip_8h_html"><div class="ttname"><a href="cne__ip_8h.html">cne_ip.h</a></div></div>
<div class="ttc" id="acne__ip_8h_html_ad3c5377f324aeb2e6822734d62518cdd"><div class="ttname"><a href="cne__ip_8h.html#ad3c5377f324aeb2e6822734d62518cdd">CNE_IPV4</a></div><div class="ttdeci">#define CNE_IPV4(a, b, c, d)</div><div class="ttdef"><b>Definition:</b> <a href="cne__ip_8h_source.html#l00047">cne_ip.h:47</a></div></div>
<div class="ttc" id="acne__log_8h_html"><div class="ttname"><a href="cne__log_8h.html">cne_log.h</a></div></div>
<div class="ttc" id="acne__log_8h_html_ac8c38301b044c47cdcdffa35550bd524"><div class="ttname"><a href="cne__log_8h.html#ac8c38301b044c47cdcdffa35550bd524">CNE_ERR_RET</a></div><div class="ttdeci">#define CNE_ERR_RET(...)</div><div class="ttdef"><b>Definition:</b> <a href="cne__log_8h_source.html#l00250">cne_log.h:250</a></div></div>
<div class="ttc" id="acne__log_8h_html_ad8375acbd0957d02439e7b8d7f3a6e22"><div class="ttname"><a href="cne__log_8h.html#ad8375acbd0957d02439e7b8d7f3a6e22">CNE_ERR_GOTO</a></div><div class="ttdeci">#define CNE_ERR_GOTO(lbl,...)</div><div class="ttdef"><b>Definition:</b> <a href="cne__log_8h_source.html#l00273">cne_log.h:273</a></div></div>
<div class="ttc" id="acne__stdio_8h_html_acb5e6a7e2a06a6e65de91e951186606d"><div class="ttname"><a href="cne__stdio_8h.html#acb5e6a7e2a06a6e65de91e951186606d">cne_printf</a></div><div class="ttdeci">CNDP_API int cne_printf(const char *fmt,...)</div></div>
<div class="ttc" id="ajcfg_8h_html"><div class="ttname"><a href="jcfg_8h.html">jcfg.h</a></div></div>
<div class="ttc" id="ajcfg_8h_html_a8f77a640370ae4142a4973cdfeaaf7ba"><div class="ttname"><a href="jcfg_8h.html#a8f77a640370ae4142a4973cdfeaaf7ba">jcfg_lport_by_index</a></div><div class="ttdeci">CNDP_API jcfg_lport_t * jcfg_lport_by_index(jcfg_info_t *jinfo, int idx)</div></div>
<div class="ttc" id="apktdev_8h_html_abe3980a568daec5be51051bcfcdc16cc"><div class="ttname"><a href="pktdev_8h.html#abe3980a568daec5be51051bcfcdc16cc">pktdev_rx_burst</a></div><div class="ttdeci">static uint16_t pktdev_rx_burst(uint16_t lport_id, pktmbuf_t **rx_pkts, const uint16_t nb_pkts)</div><div class="ttdef"><b>Definition:</b> <a href="pktdev_8h_source.html#l00183">pktdev.h:183</a></div></div>
<div class="ttc" id="apktmbuf_8h_html_a0e9d86dbe08947872697d8105e0dae54"><div class="ttname"><a href="pktmbuf_8h.html#a0e9d86dbe08947872697d8105e0dae54">pktmbuf_free</a></div><div class="ttdeci">static __cne_always_inline void pktmbuf_free(pktmbuf_t *m)</div><div class="ttdef"><b>Definition:</b> <a href="pktmbuf_8h_source.html#l00741">pktmbuf.h:741</a></div></div>
<div class="ttc" id="apktmbuf_8h_html_a77fa2b918e3052b564b228868d58c198"><div class="ttname"><a href="pktmbuf_8h.html#a77fa2b918e3052b564b228868d58c198">pktmbuf_mtod</a></div><div class="ttdeci">#define pktmbuf_mtod(m, t)</div><div class="ttdef"><b>Definition:</b> <a href="pktmbuf_8h_source.html#l00416">pktmbuf.h:416</a></div></div>
<div class="ttc" id="apktmbuf_8h_html_a9f979d8469cd4829ff0dab30defec34e"><div class="ttname"><a href="pktmbuf_8h.html#a9f979d8469cd4829ff0dab30defec34e">pktmbuf_mtod_offset</a></div><div class="ttdeci">#define pktmbuf_mtod_offset(m, t, o)</div><div class="ttdef"><b>Definition:</b> <a href="pktmbuf_8h_source.html#l00402">pktmbuf.h:402</a></div></div>
<div class="ttc" id="astructcne__acl__config_html"><div class="ttname"><a href="structcne__acl__config.html">cne_acl_config</a></div><div class="ttdef"><b>Definition:</b> <a href="cne__acl_8h_source.html#l00067">cne_acl.h:67</a></div></div>
<div class="ttc" id="astructcne__acl__config_html_aed3261c5c26c050f5808d181c9c4b974"><div class="ttname"><a href="structcne__acl__config.html#aed3261c5c26c050f5808d181c9c4b974">cne_acl_config::num_categories</a></div><div class="ttdeci">uint32_t num_categories</div><div class="ttdef"><b>Definition:</b> <a href="cne__acl_8h_source.html#l00068">cne_acl.h:68</a></div></div>
<div class="ttc" id="astructcne__acl__param_html"><div class="ttname"><a href="structcne__acl__param.html">cne_acl_param</a></div><div class="ttdef"><b>Definition:</b> <a href="cne__acl_8h_source.html#l00132">cne_acl.h:132</a></div></div>
<div class="ttc" id="astructcne__acl__param_html_a8f8f80d37794cde9472343e4487ba3eb"><div class="ttname"><a href="structcne__acl__param.html#a8f8f80d37794cde9472343e4487ba3eb">cne_acl_param::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> <a href="cne__acl_8h_source.html#l00133">cne_acl.h:133</a></div></div>
<div class="ttc" id="astructcne__acl__param_html_a91a71cf1b8f6c168408bd216322b8437"><div class="ttname"><a href="structcne__acl__param.html#a91a71cf1b8f6c168408bd216322b8437">cne_acl_param::max_rule_num</a></div><div class="ttdeci">uint32_t max_rule_num</div><div class="ttdef"><b>Definition:</b> <a href="cne__acl_8h_source.html#l00135">cne_acl.h:135</a></div></div>
<div class="ttc" id="astructcne__ipv4__hdr_html"><div class="ttname"><a href="structcne__ipv4__hdr.html">cne_ipv4_hdr</a></div><div class="ttdef"><b>Definition:</b> <a href="cne__ip_8h_source.html#l00033">cne_ip.h:33</a></div></div>
<div class="ttc" id="astructcne__ipv4__hdr_html_a0f143df6fd0e09aba2963a160e33ce16"><div class="ttname"><a href="structcne__ipv4__hdr.html#a0f143df6fd0e09aba2963a160e33ce16">cne_ipv4_hdr::version_ihl</a></div><div class="ttdeci">uint8_t version_ihl</div><div class="ttdef"><b>Definition:</b> <a href="cne__ip_8h_source.html#l00034">cne_ip.h:34</a></div></div>
<div class="ttc" id="astructcne__ipv4__hdr_html_a6dffae94f7f9ee26c196de168e4b5830"><div class="ttname"><a href="structcne__ipv4__hdr.html#a6dffae94f7f9ee26c196de168e4b5830">cne_ipv4_hdr::total_length</a></div><div class="ttdeci">cne_be16_t total_length</div><div class="ttdef"><b>Definition:</b> <a href="cne__ip_8h_source.html#l00036">cne_ip.h:36</a></div></div>
<div class="ttc" id="astructjcfg__info__s_html"><div class="ttname"><a href="structjcfg__info__s.html">jcfg_info_s</a></div><div class="ttdef"><b>Definition:</b> <a href="jcfg_8h_source.html#l00334">jcfg.h:334</a></div></div>
<div class="ttc" id="astructjcfg__lport_html"><div class="ttname"><a href="structjcfg__lport.html">jcfg_lport</a></div><div class="ttdef"><b>Definition:</b> <a href="jcfg_8h_source.html#l00167">jcfg.h:167</a></div></div>
<div class="ttc" id="astructjcfg__lport_html_a9e80a18e17fc4c6a3e11c46abcf1c8ff"><div class="ttname"><a href="structjcfg__lport.html#a9e80a18e17fc4c6a3e11c46abcf1c8ff">jcfg_lport::lpid</a></div><div class="ttdeci">uint16_t lpid</div><div class="ttdef"><b>Definition:</b> <a href="jcfg_8h_source.html#l00175">jcfg.h:175</a></div></div>
<div class="ttc" id="astructjcfg__thd_html"><div class="ttname"><a href="structjcfg__thd.html">jcfg_thd</a></div><div class="ttdef"><b>Definition:</b> <a href="jcfg_8h_source.html#l00209">jcfg.h:209</a></div></div>
<div class="ttc" id="astructjcfg__thd_html_a964ece8138f1339f5a2e693190111fed"><div class="ttname"><a href="structjcfg__thd.html#a964ece8138f1339f5a2e693190111fed">jcfg_thd::thread_type</a></div><div class="ttdeci">char * thread_type</div><div class="ttdef"><b>Definition:</b> <a href="jcfg_8h_source.html#l00212">jcfg.h:212</a></div></div>
<div class="ttc" id="astructjcfg__thd_html_ae403285ea303dd26759cbfb5f18404f1"><div class="ttname"><a href="structjcfg__thd.html#ae403285ea303dd26759cbfb5f18404f1">jcfg_thd::pause</a></div><div class="ttdeci">volatile uint16_t pause</div><div class="ttdef"><b>Definition:</b> <a href="jcfg_8h_source.html#l00221">jcfg.h:221</a></div></div>
<div class="ttc" id="astructpktmbuf__s_html"><div class="ttname"><a href="structpktmbuf__s.html">pktmbuf_s</a></div><div class="ttdef"><b>Definition:</b> <a href="pktmbuf_8h_source.html#l00102">pktmbuf.h:102</a></div></div>
<div class="ttc" id="astructpktmbuf__s_html_ad1a572736a10ff6b282c5f43c4ea1ccf"><div class="ttname"><a href="structpktmbuf__s.html#ad1a572736a10ff6b282c5f43c4ea1ccf">pktmbuf_s::data_len</a></div><div class="ttdeci">uint16_t data_len</div><div class="ttdef"><b>Definition:</b> <a href="pktmbuf_8h_source.html#l00110">pktmbuf.h:110</a></div></div>
<div class="ttc" id="astructtxbuff_html"><div class="ttname"><a href="structtxbuff.html">txbuff</a></div><div class="ttdef"><b>Definition:</b> <a href="txbuff_8h_source.html#l00044">txbuff.h:44</a></div></div>
<div class="ttc" id="atxbuff_8h_html"><div class="ttname"><a href="txbuff_8h.html">txbuff.h</a></div></div>
<div class="ttc" id="atxbuff_8h_html_a508b33f57bfcbff9904711de80477a7e"><div class="ttname"><a href="txbuff_8h.html#a508b33f57bfcbff9904711de80477a7e">txbuff_add</a></div><div class="ttdeci">CNDP_API uint16_t txbuff_add(txbuff_t *buffer, pktmbuf_t *tx_pkt)</div></div>
<div class="ttc" id="atxbuff_8h_html_ad8268b335e77a97f98b3091c73b09c7a"><div class="ttname"><a href="txbuff_8h.html#ad8268b335e77a97f98b3091c73b09c7a">txbuff_count</a></div><div class="ttdeci">static int txbuff_count(txbuff_t *buffer)</div><div class="ttdef"><b>Definition:</b> <a href="txbuff_8h_source.html#l00234">txbuff.h:234</a></div></div>
<div class="ttc" id="atxbuff_8h_html_afdf8f0e841815a554cfeb4c928442f7c"><div class="ttname"><a href="txbuff_8h.html#afdf8f0e841815a554cfeb4c928442f7c">txbuff_flush</a></div><div class="ttdeci">CNDP_API uint16_t txbuff_flush(txbuff_t *buffer)</div></div>
<div class="ttc" id="auds_8h_html_a99b1916a61869d864d8161815f7a4fc4"><div class="ttname"><a href="uds_8h.html#a99b1916a61869d864d8161815f7a4fc4">uds_append</a></div><div class="ttdeci">CNDP_API int uds_append(uds_client_t *client, const char *format,...)</div></div>
<div class="ttc" id="axskdev_8h_html_a09fbb296353240bd11bfa29b4332a8e8"><div class="ttname"><a href="xskdev_8h.html#a09fbb296353240bd11bfa29b4332a8e8">xskdev_rx_burst</a></div><div class="ttdeci">CNDP_API __cne_always_inline uint16_t xskdev_rx_burst(xskdev_info_t *xi, void **bufs, uint16_t nb_pkts)</div><div class="ttdef"><b>Definition:</b> <a href="xskdev_8h_source.html#l00168">xskdev.h:168</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
